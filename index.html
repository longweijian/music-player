<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ‰‹æœºéŸ³ä¹æ’­æ”¾å™¨</title>
    
    <!-- ä¼˜åŒ–ç§»åŠ¨è®¾å¤‡ä½“éªŒ -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    
    <!-- å¾®ä¿¡åˆ†äº«ä¼˜åŒ– -->
    <meta name="description" content="åˆ†äº«ä¸€ä¸ªå¥½å¬çš„éŸ³ä¹">
    <meta property="og:title" content="éŸ³ä¹æ’­æ”¾å™¨">
    <meta property="og:description" content="ç‚¹å‡»æ’­æ”¾å¥½å¬çš„éŸ³ä¹">
    <meta property="og:type" content="website">
    
    <style>
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #667eea, #764ba2);
            margin: 0;
            padding: 0;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            color: white;
            overflow: hidden; /* é˜²æ­¢æ»šåŠ¨ */
        }
        
        .container {
            max-width: 90%;
            width: 100%;
            padding: 20px;
            position: relative;
            z-index: 2;
        }
        
        h1 {
            font-size: 2em;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .player {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            padding: 30px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }
        
        .play-btn {
            background: #ff6b6b;
            color: white;
            border: none;
            border-radius: 50px;
            padding: 15px 30px;
            font-size: 1.2em;
            cursor: pointer;
            margin: 10px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.4);
        }
        
        .play-btn:hover {
            background: #ff5252;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 107, 107, 0.6);
        }
        
        .play-btn:active {
            transform: translateY(0);
        }
        
        .control-btn {
            background: rgba(255, 255, 255, 0.3);
            color: white;
            border: 2px solid white;
            border-radius: 50px;
            padding: 10px 20px;
            font-size: 1em;
            cursor: pointer;
            margin: 5px;
            transition: all 0.3s ease;
        }
        
        .control-btn:hover {
            background: rgba(255, 255, 255, 0.5);
        }
        
        .music-info {
            margin-top: 20px;
            font-size: 1.1em;
        }
        
        .status {
            margin-top: 20px;
            font-size: 1.1em;
            min-height: 25px;
        }
        
        .instructions {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            text-align: left;
        }
        
        .instructions h3 {
            margin-top: 0;
        }
        
        .instructions ul {
            padding-left: 20px;
        }
        
        .background-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            opacity: 0.3;
        }
        
        .floating {
            animation: float 6s ease-in-out infinite;
        }
        
        .floating:nth-child(2) {
            animation-delay: 2s;
        }
        
        .floating:nth-child(3) {
            animation-delay: 4s;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }
        
        @media (max-width: 768px) {
            h1 {
                font-size: 1.8em;
            }
            
            .player {
                padding: 20px;
            }
            
            .play-btn {
                padding: 12px 25px;
                font-size: 1.1em;
            }
        }
    </style>
</head>
<body>
    <!-- èƒŒæ™¯åŠ¨ç”»å…ƒç´  -->
    <div class="background-animation">
        <div class="floating">ğŸµ</div>
        <div class="floating">ğŸ¶</div>
        <div class="floating">â™«</div>
    </div>
    
    <div class="container">
        <h1>ğŸµ æ‰‹æœºéŸ³ä¹æ’­æ”¾å™¨ ğŸµ</h1>
        
        <div class="player">
            <button class="play-btn" onclick="startMusic()" id="playButton">ç‚¹å‡»æ’­æ”¾éŸ³ä¹</button>
            
            <div class="music-controls" style="margin-top: 20px;">
                <button class="control-btn" onclick="togglePlay()">æ’­æ”¾/æš‚åœ</button>
                <button class="control-btn" onclick="stopMusic()">åœæ­¢</button>
                <button class="control-btn" onclick="changeVolume(0.1)">éŸ³é‡+</button>
                <button class="control-btn" onclick="changeVolume(-0.1)">éŸ³é‡-</button>
            </div>
            
            <div class="music-info">
                <p>å½“å‰æ’­æ”¾: <span id="current-song">æœªé€‰æ‹©éŸ³ä¹</span></p>
            </div>
            
            <div class="status" id="status">å‡†å¤‡å°±ç»ª</div>
        </div>
        
        <div class="instructions">
            <h3>ä½¿ç”¨è¯´æ˜:</h3>
            <ul>
                <li>ç‚¹å‡»"ç‚¹å‡»æ’­æ”¾éŸ³ä¹"æŒ‰é’®å¼€å§‹æ’­æ”¾éŸ³ä¹</li>
                <li>éŸ³ä¹å°†è‡ªåŠ¨å¾ªç¯æ’­æ”¾</li>
                <li>å¯ä»¥ä½¿ç”¨ä¸‹æ–¹æ§åˆ¶æŒ‰é’®è¿›è¡Œæ’­æ”¾æ§åˆ¶</li>
                <li>è¯·å°†æ‚¨çš„éŸ³ä¹æ–‡ä»¶æ”¾åœ¨ music/ ç›®å½•ä¸‹</li>
                <li>æ”¯æŒçš„æ ¼å¼: MP3, WAV, OGG</li>
            </ul>
        </div>
    </div>
    
    <!-- éŸ³é¢‘å…ƒç´  -->
    <audio id="music-player" loop preload="auto" x5-playsinline="true" playsinline="true">
        <source id="music-source" src="" type="audio/mpeg">
        æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒéŸ³é¢‘æ’­æ”¾ã€‚
    </audio>
    
    <script>
        // éŸ³ä¹æ–‡ä»¶åˆ—è¡¨ - ä½ å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ ä½ çš„éŸ³ä¹æ–‡ä»¶
        const musicFiles = [
            'music/M800003xecOB1ALwP9.mp3'
        ];
        
        let currentSongIndex = 0;
        let audio = document.getElementById('music-player');
        let source = document.getElementById('music-source');
        let statusDiv = document.getElementById('status');
        let currentSongSpan = document.getElementById('current-song');
        let playButton = document.getElementById('playButton');
        
        // è®¾ç½®éŸ³é¢‘å…ƒç´ 
        audio.volume = 0.7; // é»˜è®¤éŸ³é‡70%
        
        // å¼€å§‹æ’­æ”¾éŸ³ä¹
        function startMusic() {
            if (musicFiles.length === 0) {
                alert('è¯·å…ˆæ·»åŠ éŸ³ä¹æ–‡ä»¶åˆ° music/ ç›®å½•ä¸‹');
                return;
            }
            
            // è®¾ç½®å½“å‰æ­Œæ›²
            source.src = musicFiles[currentSongIndex];
            currentSongSpan.textContent = getFileName(musicFiles[currentSongIndex]);
            audio.load(); // åŠ è½½éŸ³é¢‘
            audio.play().then(() => {
                statusDiv.textContent = 'æ­£åœ¨æ’­æ”¾: ' + getFileName(musicFiles[currentSongIndex]);
                console.log('éŸ³ä¹å¼€å§‹æ’­æ”¾');
                playButton.textContent = 'éŸ³ä¹æ’­æ”¾ä¸­...';
                playButton.disabled = true;
                
                // è®°å½•æ’­æ”¾çŠ¶æ€
                localStorage.setItem('musicPlaying', 'true');
            }).catch(error => {
                statusDiv.textContent = 'æ’­æ”¾å¤±è´¥: ' + error.message;
                console.error('æ’­æ”¾å¤±è´¥:', error);
                
                // å°è¯•åœ¨ç”¨æˆ·äº¤äº’åæ’­æ”¾ï¼ˆæŸäº›æµè§ˆå™¨éœ€è¦ç”¨æˆ·äº¤äº’ï¼‰
                setTimeout(() => {
                    audio.play().then(() => {
                        statusDiv.textContent = 'æ­£åœ¨æ’­æ”¾: ' + getFileName(musicFiles[currentSongIndex]);
                        playButton.textContent = 'éŸ³ä¹æ’­æ”¾ä¸­...';
                        playButton.disabled = true;
                        localStorage.setItem('musicPlaying', 'true');
                    }).catch(err => {
                        statusDiv.textContent = 'éœ€è¦å†æ¬¡ç‚¹å‡»æ’­æ”¾: ' + err.message;
                    });
                }, 500);
            });
        }
        
        // æ’­æ”¾/æš‚åœåˆ‡æ¢
        function togglePlay() {
            if (audio.paused) {
                audio.play().then(() => {
                    statusDiv.textContent = 'æ­£åœ¨æ’­æ”¾: ' + getFileName(musicFiles[currentSongIndex]);
                    playButton.textContent = 'éŸ³ä¹æ’­æ”¾ä¸­...';
                    playButton.disabled = true;
                    localStorage.setItem('musicPlaying', 'true');
                }).catch(error => {
                    statusDiv.textContent = 'æ’­æ”¾å¤±è´¥: ' + error.message;
                    console.error('æ’­æ”¾å¤±è´¥:', error);
                });
            } else {
                audio.pause();
                statusDiv.textContent = 'å·²æš‚åœ';
                playButton.textContent = 'ç»§ç»­æ’­æ”¾éŸ³ä¹';
                playButton.disabled = false;
                localStorage.setItem('musicPlaying', 'false');
            }
        }
        
        // åœæ­¢éŸ³ä¹
        function stopMusic() {
            audio.pause();
            audio.currentTime = 0; // é‡ç½®åˆ°å¼€å¤´
            statusDiv.textContent = 'å·²åœæ­¢';
            playButton.textContent = 'é‡æ–°æ’­æ”¾éŸ³ä¹';
            playButton.disabled = false;
            localStorage.setItem('musicPlaying', 'false');
        }
        
        // æ”¹å˜éŸ³é‡
        function changeVolume(change) {
            let newVolume = audio.volume + change;
            if (newVolume < 0) newVolume = 0;
            if (newVolume > 1) newVolume = 1;
            audio.volume = newVolume;
            statusDiv.textContent = 'éŸ³é‡: ' + Math.round(newVolume * 100) + '%';
        }
        
        // è·å–æ–‡ä»¶åï¼ˆä¸åŒ…å«è·¯å¾„ï¼‰
        function getFileName(filePath) {
            return filePath.split('/').pop().split('\\').pop();
        }
        
        // å½“éŸ³é¢‘æ’­æ”¾ç»“æŸæ—¶ï¼ˆå¾ªç¯æ’­æ”¾ï¼‰
        audio.addEventListener('ended', function() {
            // ç”±äºè®¾ç½®äº† loop å±æ€§ï¼ŒéŸ³é¢‘ä¼šè‡ªåŠ¨å¾ªç¯ï¼Œè¿™é‡Œåªæ˜¯æä¾›é¢å¤–ä¿éšœ
            statusDiv.textContent = 'éŸ³ä¹å¾ªç¯æ’­æ”¾ä¸­...';
            // å¦‚æœéœ€è¦æ’­æ”¾åˆ—è¡¨åŠŸèƒ½ï¼Œå¯ä»¥åœ¨è¿™é‡Œåˆ‡æ¢åˆ°ä¸‹ä¸€é¦–
        });
        
        // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
        window.addEventListener('load', function() {
            statusDiv.textContent = 'å‡†å¤‡å°±ç»ª - ç‚¹å‡»æŒ‰é’®æ’­æ”¾éŸ³ä¹';
            
            // å°è¯•è‡ªåŠ¨æ’­æ”¾ï¼ˆåœ¨æŸäº›æµè§ˆå™¨ä¸­å¯èƒ½éœ€è¦ç”¨æˆ·äº¤äº’ï¼‰
            // å¦‚æœä¹‹å‰æ­£åœ¨æ’­æ”¾ï¼Œå°è¯•æ¢å¤
            if (localStorage.getItem('musicPlaying') === 'true') {
                // å»¶è¿Ÿä¸€æ®µæ—¶é—´å†å°è¯•è‡ªåŠ¨æ’­æ”¾
                setTimeout(() => {
                    audio.play().then(() => {
                        statusDiv.textContent = 'æ­£åœ¨æ’­æ”¾: ' + getFileName(musicFiles[currentSongIndex]);
                        playButton.textContent = 'éŸ³ä¹æ’­æ”¾ä¸­...';
                        playButton.disabled = true;
                    }).catch(error => {
                        console.error('è‡ªåŠ¨æ’­æ”¾å¤±è´¥:', error);
                        // è‡ªåŠ¨æ’­æ”¾å¤±è´¥æ—¶ï¼Œä¿æŒæŒ‰é’®å¯ç‚¹å‡»
                        playButton.textContent = 'ç‚¹å‡»æ’­æ”¾éŸ³ä¹';
                        playButton.disabled = false;
                    });
                }, 1500); // å»¶è¿Ÿ1.5ç§’å°è¯•è‡ªåŠ¨æ’­æ”¾
            }
        });
        
        // é¡µé¢å¯è§æ€§API - å¤„ç†åå°æ’­æ”¾
        document.addEventListener('visibilitychange', function() {
            if (document.visibilityState === 'hidden') {
                // é¡µé¢éšè—æ—¶ï¼Œè®°å½•æ’­æ”¾çŠ¶æ€
                if (!audio.paused) {
                    localStorage.setItem('musicPlaying', 'true');
                }
            } else {
                // é¡µé¢æ˜¾ç¤ºæ—¶ï¼Œå¦‚æœä¹‹å‰åœ¨æ’­æ”¾ï¼Œå°è¯•ç»§ç»­æ’­æ”¾
                if (localStorage.getItem('musicPlaying') === 'true') {
                    setTimeout(() => {
                        audio.play().then(() => {
                            statusDiv.textContent = 'æ­£åœ¨æ’­æ”¾: ' + getFileName(musicFiles[currentSongIndex]);
                            playButton.textContent = 'éŸ³ä¹æ’­æ”¾ä¸­...';
                            playButton.disabled = true;
                        }).catch(error => {
                            console.error('æ¢å¤æ’­æ”¾å¤±è´¥:', error);
                            // å¦‚æœæ¢å¤å¤±è´¥ï¼Œè‡³å°‘æ›´æ–°çŠ¶æ€
                            statusDiv.textContent = 'è¿”å›é¡µé¢ - ç‚¹å‡»ç»§ç»­æ’­æ”¾';
                        });
                    }, 500);
                }
            }
        });
        
        // é¡µé¢å…³é—­æˆ–åˆ·æ–°å‰çš„å¤„ç†
        window.addEventListener('beforeunload', function() {
            if (!audio.paused) {
                localStorage.setItem('musicPlaying', 'true');
            } else {
                localStorage.setItem('musicPlaying', 'false');
            }
        });
        
        // ç›‘å¬éŸ³é¢‘æš‚åœäº‹ä»¶
        audio.addEventListener('pause', function() {
            // å½“éŸ³é¢‘æš‚åœæ—¶æ›´æ–°UI
            if (localStorage.getItem('musicPlaying') === 'true') {
                // ä»…æ›´æ–°UIçŠ¶æ€ï¼Œä¸è‡ªåŠ¨æ¢å¤æ’­æ”¾ä»¥é¿å…ç”¨æˆ·ä½“éªŒé—®é¢˜
                statusDiv.textContent = 'éŸ³ä¹å·²æš‚åœï¼ˆåå°æ’­æ”¾å¯èƒ½ç»§ç»­ï¼‰';
            }
        });
        
        // å°è¯•åœ¨é¡µé¢ç„¦ç‚¹å˜åŒ–æ—¶æ¢å¤éŸ³é¢‘æ’­æ”¾
        window.addEventListener('focus', function() {
            if (localStorage.getItem('musicPlaying') === 'true' && audio.paused) {
                setTimeout(() => {
                    audio.play().then(() => {
                        statusDiv.textContent = 'æ­£åœ¨æ’­æ”¾: ' + getFileName(musicFiles[currentSongIndex]);
                        playButton.textContent = 'éŸ³ä¹æ’­æ”¾ä¸­...';
                        playButton.disabled = true;
                    }).catch(error => {
                        console.error('ç„¦ç‚¹æ¢å¤æ’­æ”¾å¤±è´¥:', error);
                    });
                }, 300);
            }
        });
        
        // é˜²æ­¢é¡µé¢è¢«æ„å¤–å…³é—­
        window.addEventListener('beforeunload', function(e) {
            if (localStorage.getItem('musicPlaying') === 'true') {
                e.preventDefault();
                e.returnValue = 'éŸ³ä¹æ­£åœ¨æ’­æ”¾ï¼Œç¡®å®šè¦ç¦»å¼€å—ï¼Ÿ';
            }
        });
        
        // é˜»æ­¢ç”¨æˆ·é€šè¿‡åé€€æŒ‰é’®é€€å‡º
        window.addEventListener('popstate', function(e) {
            if (localStorage.getItem('musicPlaying') === 'true') {
                history.pushState(null, null, location.href);
                e.preventDefault();
                e.stopPropagation();
            }
        });
        
        // é¡µé¢åŠ è½½åç«‹å³è®¾ç½®å†å²è®°å½•çŠ¶æ€ï¼Œé˜²æ­¢åé€€
        window.addEventListener('load', function() {
            history.pushState(null, null, location.href);
        });
        
        // ç›‘å¬é”®ç›˜äº‹ä»¶ï¼ˆå¦‚Alt+F4, Ctrl+Wç­‰ï¼‰
        window.addEventListener('keydown', function(e) {
            // é˜»æ­¢Ctrl+W, Ctrl+Q, F5ç­‰å¿«æ·é”®
            if ((e.ctrlKey && (e.keyCode === 87 || e.keyCode === 81)) || 
                e.keyCode === 116) {
                if (localStorage.getItem('musicPlaying') === 'true') {
                    e.preventDefault();
                    e.stopPropagation();
                    return false;
                }
            }
        });
    </script>
</body>
</html>
